FUNCTION-POOL THFB       MESSAGE-ID 00 NO STANDARD PAGE HEADING.

TYPE-POOLS: STREE, THFB.

TABLES: TCPIC, WPINFO, VBHDR, VBMOD, VBDATA, VBERROR, VBPARAM, SM04DIC,
        TNMAP, APSRV.

INCLUDE LMSGSERVERDEF.
INCLUDE RSADMKEY.
INCLUDE TSKHINCL.
INCLUDE RSUSRCOM.
INCLUDE LSGWYDEF.
INCLUDE <COLOR>.
include thrt_runtime_internal.

TYPES:
  INTERVAL_TREE     LIKE SNODETEXT,
  INTERVAL_TREE_TBL TYPE INTERVAL_TREE OCCURS 0,
  INTERVAL          LIKE PFTIINTREC,
  INTERVAL_TBL      TYPE INTERVAL OCCURS 0.

* Dynpro Felder fuer Trace Komponenten
DATA: TRC TYPE THFB_TRACE,
      TRC_SELECTABLE TYPE THFB_TRACE,
      TRC_LEVEL(2),
      TRC_EXIT,
      TRC_SET,
      TRC_ONLY_COMP,
      TRC_ALL_INPUT,
      TRC_TITLE(10),
      WPTYPE LIKE SM04DIC-WP_TYPE.

DATA: INTERVAL_TREE TYPE INTERVAL_TREE_TBL WITH HEADER LINE.

DATA: MYUCOMM LIKE SY-UCOMM.

DATA: GLOB_SERVER   LIKE MSXXLIST-NAME,
      BLANK(40).

DATA: BEGIN OF GLOB_SERVER_LIST OCCURS 0.
        INCLUDE STRUCTURE MSXXLIST.
DATA: END OF GLOB_SERVER_LIST.

DATA: BEGIN OF ERR_PROG OCCURS 50,
        LINE(256),
      END OF ERR_PROG.
DATA: BEGIN OF ERR_TOP OCCURS 50,
        LINE(256),
      END OF ERR_TOP.
DATA: BEGIN OF VBKEY,
        KEY      LIKE VBMOD-VBKEY,
        ID       LIKE VBMOD-VBMODCNT,
      END OF VBKEY.
DATA: BEGIN OF ERR_STRUC,
        FERRNAME LIKE TFDIR-FUNCNAME,
        FINISH   LIKE TFDIR-FUNCNAME,
        FUNCNAME LIKE TFDIR-FUNCNAME,
        PNAME    LIKE TFDIR-PNAME,
        INCLUDE  LIKE TFDIR-INCLUDE,
      END OF ERR_STRUC.

DATA: BEGIN OF ERR_TAB OCCURS 50,
        KEY      LIKE VBMOD-VBKEY,
        ID       LIKE VBMOD-VBMODCNT,
      END OF ERR_TAB.

DATA: TIME    LIKE SY-UZEIT,
      DATE    LIKE SY-DATUM,
      VBSTAT(4),
      FORM_NAME(30),
      FORM_LINE(256),
      FUNC_ERR LIKE TFDIR-FUNCNAME,
      ERR_REPO LIKE SY-REPID,
      PROG_PREFIX(3) VALUE '%_V',
      OKCODE LIKE SY-UCOMM,
      T1 TYPE I.

DATA: BEGIN OF TRACE OCCURS 0.
        INCLUDE STRUCTURE USERTRACE.
DATA: END OF TRACE.

DATA: BEGIN OF TRACE2 OCCURS 0.
        INCLUDE STRUCTURE USERTRACE.
DATA: END OF TRACE2.

DATA: BEGIN OF WPLIST OCCURS 0.
        INCLUDE STRUCTURE WPINFO.
DATA: END OF WPLIST.
DATA: BEGIN OF FIELD_TAB OCCURS 10,
        ORIG_FIELD_NAME(32),
        TECH_FIELD_NAME(32),
      END OF FIELD_TAB.

----------------------------------------------------------------------------------
Extracted by Mass Download version 1.4.6 - E.G.Mellodew. 1998-2024. Sap Release 754
